<div [ngClass]="{'justify-content-between': showCreate, 'justify-content-end': !showCreate}"
     class="sm:flex align-items-center mb-3">
  <button (click)="createItem()" *ngIf="showCreate && !itemsSplit?.length"
          class="p-button-outlined" icon="mdi mdi-plus" label="{{'common.create' | translate}}"
          pButton pTooltip="{{'common.tooltip.create' | translate: {value: (name | translate)} }}"
          tooltipPosition="top" type="button"></button>
  <p-splitButton (onClick)="createItem()" *ngIf="showCreate && itemsSplit?.length"
                 [model]="itemsSplit" appendTo="body" icon="mdi mdi-plus"
                 label="{{'common.create' | translate}}"
                 pTooltip="{{'common.tooltip.create' | translate: {value: (name | translate)} }}"
                 styleClass="p-button-outlined" tooltipPosition="top"
  ></p-splitButton>
  <div>
    <span class="p-input-icon-left">
      <i class="mdi mdi-magnify"></i>
      <input #inputSearch (input)="setGlobalFilter($event, dt)" pInputText
             placeholder="{{'common.search' | translate}}" type="text"/>
    </span>
    <button (click)="refreshContentData(dt)" class="ml-2 p-button-rounded p-button-text" icon="mdi mdi-replay"
            pButton
            pTooltip="{{'common.tooltip.refresh' | translate}}" tooltipPosition="left" type="button"></button>
    <button (click)="showPrintModal()" *ngIf="exportBtn" class="ml-2 p-button-rounded p-button-text"
            icon="mdi mdi-table-arrow-down" pButton
            pTooltip="{{'common.tooltip.print' | translate}}" tooltipPosition="left" type="button"></button>
  </div>
</div>
<p-table #dt (onLazyLoad)="loadCustomLazy($event)" (onRowReorder)=rowReorder($event,dt) [columns]="headers"
         [first]="service.pageRecord" [lazyLoadOnInit]="service.lazyLoadOnInit" [lazy]="service.serverSide"
         [paginator]="pagination" [resizableColumns]="true" [rowsPerPageOptions]="rowsPerPageOptions"
         [rows]="service.pageSize"
         [totalRecords]="service.total$ | async | asyncNumber"
         [value]="service.listEntities$ | async | asyncTable"
         dataKey="id" responsiveLayout="scroll" styleClass=" {{class}}"
>
  <ng-template let-columns pTemplate="header">
    <tr>
      <th *ngIf="rowExpansion || rowDragAndDrop" [style.width.px]="50"></th>
      <th *ngIf="rowDragAndDrop" class="text-center">No.</th>
      <ng-template [ngForOf]="columns" let-item ngFor>
        <ng-template [ngIfElse]="headWidthSort" [ngIf]="!item.sort">
          <th [class]="item.class" [style.max-width.px]="item?.width">
            {{ item.header | translate }}
          </th>
        </ng-template>
        <ng-template #headWidthSort>
          <th [class]="item.class" [pSortableColumn]="item?.sortField ? item?.sortField : item.field"
              [style.max-width.px]="item?.width">
            {{ item.header | translate }}
            <p-sortIcon [field]="item?.sortField ? item?.sortField : item.field"></p-sortIcon>
          </th>
        </ng-template>
      </ng-template>
    </tr>
  </ng-template>
  <ng-template let-columns="columns" let-expanded="expanded" let-index="rowIndex" let-rowData pTemplate="body">
    <tr [pReorderableRow]="index">
      <td *ngIf="rowExpansion">
        <button [icon]="expanded ? 'mdi mdi-chevron-down' : 'mdi mdi-chevron-right'"
                [pRowToggler]="rowData"
                class="p-button-text p-button-rounded p-button-plain" pButton type="button"></button>
      </td>
      <ng-container *ngIf="rowDragAndDrop">
        <td>
          <span class="mdi mdi-drag-variant" pReorderableRowHandle></span>
        </td>
        <td class="text-center">
          {{ index + 1 }}
        </td>
      </ng-container>
      <td *ngFor="let col of columns" [class]="col.class" [style.max-width.px]="col?.width">
        <ng-template [ngIfElse]="plainRow" [ngIf]="col?.pipe || col?.inject">
          <ng-template [ngIfElse]="itemPipe" [ngIf]="col?.inject">
            <ng-container [ngTemplateOutletContext]="{data: rowAndColumn(rowData, col)}"
                          [ngTemplateOutlet]="injectTemplate(col.field)">
            </ng-container>
          </ng-template>
          <ng-template #itemPipe>
            <!-- <c-show-value
               [data]="{value: rowData[col.field], pipe: col.pipe, extraVal: col?.extraVal}">
             </c-show-value>-->
          </ng-template>
        </ng-template>
        <ng-template #plainRow>
          <ng-template [ngIfElse]="elsePlain" [ngIf]="col.field === 'action' && action">
            <ng-container [ngTemplateOutletContext]="{data: rowData}"
                          [ngTemplateOutlet]="actionExtra">
            </ng-container>
            <button (click)="editItem(rowData)" *ngIf="showEdit"
                    class="p-button-rounded p-button-text" icon="mdi mdi-pencil"
                    pButton
                    pTooltip="{{'common.tooltip.edit' | translate: {value: (name | translate)} }}"
                    tooltipPosition="top" type="button"></button>
            <button (click)="deleteItem($event, rowData)" *ngIf="showDelete"
                    class="p-button-rounded p-button-text" icon="mdi mdi-trash-can-outline"
                    pButton
                    pTooltip="{{'common.tooltip.delete' | translate: {value: (name | translate)} }}"
                    tooltipPosition="top" type="button"></button>
          </ng-template>
          <ng-template #elsePlain>
            {{ rowData[col.field] | translate }}
          </ng-template>
        </ng-template>
      </td>
    </tr>
  </ng-template>
  <ng-template let-columns="columns" let-expand pTemplate="rowexpansion">
    <ng-container [ngTemplateOutletContext]="{data: rowAndColumn(expand, columns)}"
                  [ngTemplateOutlet]="expansionSlot">
    </ng-container>
  </ng-template>
  <ng-template pTemplate="emptymessage">
    <tr>
      <td *ngIf="search" [attr.colspan]="rowExpansion ? headers.length  + 1: headers.length"
          class="justify-content-center text-2xl text-center">
        {{ 'common.blankSearch' | translate:{value: search} }}
      </td>
      <td *ngIf="!search" [attr.colspan]="rowExpansion ? headers.length  + 1: headers.length"
          class="justify-content-center text-2xl text-center">
        {{ 'common.blankData' | translate }}
      </td>
    </tr>
  </ng-template>
  <ng-template let-state pTemplate="paginatorright">
    {{ 'common.paginator' | translate: {first: state.first, rows: state.rows, total: state.totalRecords} }}
  </ng-template>
</p-table>
<!--Confirm dialog for delete action-->
<p-confirmDialog [baseZIndex]="10000" [style]="{width: '30rem'}" rejectButtonStyleClass="p-button-text">
</p-confirmDialog>
